<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<head>
	<title>Accueil du Eportfolio 4 &eacute;toiles</title>
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
	<!-- =========================================== -->
	<link rel="stylesheet" type="text/css" href="../../other/css/bootstrap.min.css" />
	<link rel="stylesheet" type="text/css" href="../../other/css/bootstrap-responsive.min.css" />
	<link rel="stylesheet" type="text/css" href="../../other/css/bootstrap-wysihtml5.css" />
	<link rel="stylesheet" type="text/css" href="../../other/css/jquery-ui.css" />
	<link rel="stylesheet" type="text/css" href="../../other/css/font-awesome/css/font-awesome.min.css" />
	<link rel="stylesheet" type="text/css" href="../../karuta/css/karuta.css" />
	<link rel="stylesheet" type="text/css" href="../../other/pick-a-color/css/pick-a-color-1.1.8.min.css" />
	<!-- =========================================== -->
	<script src="../../other/js/jquery-1.10.2.js"></script>
	<script src="../../other/js/jquery-ui-1.10.3.custom.min.js"></script>
	<script src="../../other/bootstrap/js/bootstrap.min.js"></script>
	<script src='../../other/wysihtml5/wysihtml5-0.3.0.js'> </script>
	<script src='../../other/wysihtml5/parser.js'> </script>
	<script src="../../other/js/jquery.browser.js"></script>
	<script src="../../other/js/jquery-iframe-auto-height.js"></script>
	<!--[if lt IE 9]>
		<script src='http://html5shiv.googlecode.com/svn/trunk/html5.js'></script>
	<![endif]-->
	<script src="../../other/js/bootstrap-wysihtml5.js"></script>
	<script src="../../other/js/jquery_hotkeys.js"></script>
	<script src="../../other/js/JQueryRC4.js"></script>
	<script src="../../other/js/spin.js"></script>
	<script src="../../other/js/jquery.spin.js"></script>
	<script src="../../other/js/js.cookie.js"></script>
	<!-- =============================================================== -->
	<script src="../../karuta/js/karuta.js"></script>
	<script src="../../karuta/js/UICom.js"></script>
	<!-- =============================================================== -->
	<script src="../../karuta/js/model/Type_Portfolio.js"></script>
	<script src="../../karuta/js/model/Type_Node.js"></script>
	<script src="../../karuta/js/model/Type_User.js"></script>
	<script src="../../karuta/js/UICom.js"></script>
	<!-- =============================================================== -->
	<link type="text/css" href="../../other/lightbox/css/lightbox.css" rel="stylesheet" />
	<script src="../../other/lightbox/js/lightbox-2.6.min.js"></script>
	<!-- =============================================================== -->
	<link type="text/css" href="../../other/jplayer/jplayer.blue.monday.css" rel="stylesheet" />
	<script src="../../other/jplayer/jquery.jplayer.min.js"></script>
	<!-- =============================================================== -->
	<script src="../../other/js/jquery.ui.widget.js"></script>
	<script src="../../other/js/jquery.iframe-transport.js"></script>
	<script src="../../other/js/jquery.fileupload.js"></script>
	<!-- =============================================================== -->
	<script src="../../other/bootstrap-datepicker/bootstrap-datepicker.js"></script>
	<script src="../../other/bootstrap-datepicker/bootstrap-datepicker.fr.js"></script>
	<link rel="stylesheet" href="../../other/bootstrap-datepicker/datepicker.css" />
	<!-- =============================================================== -->
	<script src="../../karuta/js/resources/Type_Calendar.js"></script>
	<script src="../../karuta/js/resources/Type_Comments.js"></script>
	<script src="../../karuta/js/resources/Type_Document.js"></script>
	<script src="../../karuta/js/resources/Type_Proxy.js"></script>
	<script src="../../karuta/js/resources/Type_TextField.js"></script>
	<script src="../../karuta/js/resources/Type_Field.js"></script>
	<script src="../../karuta/js/resources/Type_Image.js"></script>
	<script src="../../karuta/js/resources/Type_Get_Resource.js"></script>
	<script src="../../karuta/js/resources/Type_Get_Get_Resource.js"></script>
	<script src="../../karuta/js/resources/Type_URL.js"></script>
	<script src="../../karuta/js/resources/Type_Item.js"></script>
	<script src="../../karuta/js/resources/Type_Video.js"></script>
	<script src="../../karuta/js/resources/Type_Color.js"></script>
	<!-- =============================================================== -->
	<script src="../../application/js/bubble.js"></script>
	<script src="../../application/_init.js"></script>
	<!-- =============================================================== -->
	<script src="../../karuta/js/version.js"></script>
	<!-- =============================================================== -->
	<script src="../../karuta/js/languages/locale_fr.js"></script>
	<!-- =============================================================== -->
	<script src="../js/iut2.js"></script>
	<script src="../js/locale_lang.js"></script>
	<script src="../js/experience.js"></script>
	<script src="../js/experience_perso.js"></script>
	<script src="../js/diploma.js"></script>
	<script src="../js/stage.js"></script>
	<script src="../js/formation.js"></script>
	<script src="../js/alternance.js"></script>
	<script src="../js/projet.js"></script>
	<script src="../js/contact.js"></script>
	<script src="../js/fullcontact.js"></script>
	<script src="../js/competence.js"></script>
	<script src="../js/qualites_perso.js"></script>
	<script src="../js/profile.js"></script>
	<script src="../js/cv.js"></script>
	<script src="../js/langue.js"></script>
	<script src="../js/feedback.js"></script>
	<script src="../js/monprojet.js"></script>
	<script src="../js/help.js"></script>
	<!-- =========================================== -->
	<script src="../../other/colorpicker/js/evol.colorpicker.min.js"></script>
	<link type="text/css" href="../../other/colorpicker/css/evol.colorpicker.min.css" rel="stylesheet" />
	
	<script src="../../other/pick-a-color/js/tinycolor-0.9.15.min.js"></script>
	<script src="../../other/pick-a-color/js/pick-a-color-1.1.8.min.js"></script>
	<script src="../../other/js/jquery-qrcode-0.14.0.js"></script>
	<script src="../../other/js/ZeroClipboard.js"></script>
	<!-- =========================================== -->
	<link rel="stylesheet" href="../../application/css/specific.css" />
	
</head>
<body>
	<div id="container" class="container">

		<div id="navbar" class="navbar navbar-fixed-top"></div>

		<ol class="breadcrumb">
			<li><a href="#">Accueil</a><span class="divider">/</span></li>
				<li id='view_label' class="active">Mes e-portfolio suivis</li>
		</ol>

		<h3 class="align-left"><i class="fa fa-tasks"></i> MES E-PORTFOLIOS SUIVIS</h3>

		<!-- ====================================================================== -->
		<div id="feedback-section">

			<blockquote>Dans cette rubriquesont listés tous les e-portfolios que vous suivez en tant que superviseur.</blockquote>
			<div class='supervises'>
				<div class='row ligne1'>
					<div class='span2 supervises-titles'>Nom</div>
					<div class='span2 supervises-titles'>Prénom</div>					
				</div>
				<div id='supervises'></div>
				<div id='loader'><img src='../../karuta/img/ajax-loader.gif'/></div>
			</div>
		</div>
	</div>
	<!-- ====================================================================== -->
	<div id="footer" class="container-fluid" ></div>
	<!-- ====================================================================== -->
	
	<!-- ==================== feedback box ==================================== -->
	<div id='feedback-window' class='modal hide fade'>
		<div id='feedback-window-header' class='modal-header' style='text-align:left'><h4>Demande de feedback</h4></div>
		<div id='feedback-window-body' class='modal-body'></div>
	</div>
	<!-- ====================================================================== -->
	
	<script language='javascript'>

	var portfolioid = getURLParameter('portfolioid');
	var profileid = getURLParameter('profileid');
	var l_userrole = 'superviseur';
	
	//====================================
	function displayPortfolio(portfolioid,portfoliocode,profileid)
	//====================================
	{
		$.ajax({
			type : "GET",
			dataType : "xml",
			url : "../../../"+serverBCK+"/portfolios/portfolio/" + portfolioid + "?resources=true",
			success : function(data) {
				UICom.parseStructure(data);
				UIFactory["Feedback"].parse(data,portfolioid);
				$.ajax({
					type : "GET",
					dataType : "xml",
					url : "../../../"+serverBCK+"/portfolios/portfolio/" + profileid + "?resources=true",
					success : function(data) {
						UICom.parseStructure(data);
						UIFactory["Profile"].parse(data);
						//--------------------------
						var html = "";
						html += "<div class='row ligne2'>";
						html += "	<div class='span2' id='nom_"+portfolioid+"'></div>";
						html += "	<div class='span2' id='prenom_"+portfolioid+"'></div>";
						html += "	<div class='span4' id='demande_"+portfolioid+"'></div>";
						html += "	<div class='span2' id='date_"+portfolioid+"'></div>";		
						html += "</div>"
						$("#supervises").append(html);
						//--------------------------
						var nom = UICom.structure["ui"][profiles_list[0].lastname_nodeid].resource.getView();
						var prenom = UICom.structure["ui"][profiles_list[0].firstname_nodeid].resource.getView();
		//				var link = "<a href='mainEtudiant2.htm?portfolioid="+portfolioid+"' target='_blank'>"+nom+"</a>";
						var link = "<a href='mainEtudiant2.htm?code="+portfoliocode+"' target='_blank'>"+nom+"</a>";
						$("#nom_"+portfolioid).html(link);
						$("#prenom_"+portfolioid).html(prenom);
						//--------------------------
						for ( var i = 0; i < feedbacks_list[portfolioid].length; i++) {
							var suivi = UIFactory["Feedback"].displaySuivi(portfolioid,feedbacks_list[portfolioid][i].id,nom,prenom);
							if (suivi)
								break;
						}
						//--------------------
						$('a[data-toggle=tooltip]').tooltip({html:true});

					}
				});
			}
		});
	}

	//====================================
	function selectPortfolioPourSuperviseur(data)
	//====================================
	{
		var codePortfolio = "portfolio";// + useridentifier;
		var codeProfile = "profile";// + useridentifier;
		var portfolios = $("portfolio",data);
		var code = '';
		var portfolioid = '';
		var profileid = '';
		for ( var i=0;i<portfolios.length;i++) {
			var current_code = $("code:first",portfolios[i]).text();
			if (current_code.indexOf(codePortfolio)>-1) {
				portfolioid = $(portfolios[i]).attr("id");
				code = current_code.substring(current_code.indexOf("."),current_code.lastIndexOf("-")+1);
				for ( var j=0;j<portfolios.length;j++) {
					var code1 = $("code:first",portfolios[j]).text();
					if (code1.indexOf(code+codeProfile)>-1) {
						profileid = $(portfolios[j]).attr("id");
					}
				}
				displayPortfolio(portfolioid,code,profileid);
			}
		}
		$("#loader").hide();
	}


	$(document).ready(function() {
		$("#footer").html(footer);
		$.ajaxSetup({async: false});
		//----------------
		$.ajax({
			type : "GET",
			dataType : "xml",
			url : "../../../"+serverBCK+"/credential",
			data: "",
			success : function(data) {
				USER = new UIFactory["User"]($("user",data));
				var navbar = getNavbar(portfolioid,profileid);
				$("#navbar").html(navbar);
			}
		});
		//----------------
		$.ajax({
			Accept: "application/xml",
			contentType: "application/xml",
			type : "GET",
			dataType : "xml",
			url : "../../../"+serverBCK+"/portfolios?active=1",
			success : function(data) {
				UIFactory["Portfolio"].parse(data);
				selectPortfolioPourSuperviseur(data);
			}
		});
		//----------------

	});
	


	
	</script>
</body>
</html>